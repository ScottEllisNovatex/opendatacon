<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8"/>
    <title>Mimic</title>

    <script src="/js/jquery.min.js"></script>
  </head>

  <body>
    <svg id="mimic-svg" xmlns="http://www.w3.org/2000/svg" width="601.81927" height="725.12518"></svg>
    <script>

      // Send the data using post
      $( document ).ready(function() {
          target = new URL(window.location.href).searchParams.get('target');

          const mimic_name = "dmc";
          const mimic_SVG = "/mimics/" + mimic_name + ".svg";
          const mimic_JS = "/mimics/" + mimic_name + ".js";

          jQuery.getScript(mimic_JS)
              .done(function() {
                  console.log(mimic_JS + " loaded successfully !!!");
              });

          $('#mimic-svg').load(mimic_SVG, null, function() {
              window.setInterval(function() { refresh_values(target);  }, 1000);
          });
      });

      function refresh_values(target) {
          var getResponders = $.post( "/DataPorts/CurrentState", { Target : target } )
              .done(function( data ) {
                  updateMimic(document.getElementById("mimic-svg"), data);
              });
      }

    </script>
  </body>

</html>
