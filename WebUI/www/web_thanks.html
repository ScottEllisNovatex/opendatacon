<!-- >var row = '<a href="javascript:void(0);" onclick="post_to_server(\'' + data["Items"][target] + '\', \'' + data["Commands"][command] + '\');">' + data["Commands"][command] + '</a>' -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OpenDataCon</title>

    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.jquery-3.2.1.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/jquery.dataTables.min.js"></script>

    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/jquery.dataTables.css" rel="stylesheet">
  </head>

  <body>
    <h1 style="text-align:center"> Data Ports </h1>
    <table id="DataPortsTable" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
      <thead>
        <tr id="DataPortsTableHeader">
          <th>Port Name</th>
        </tr>
      </thead>
      <tbody id="DataPortsTableBody"/>
    </table>

    <h1 style="text-align:center">Data Connectors</h1>
    <table id="DataConnectorsTable" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
      <thead>
        <tr id="DataConnectorsTableHeader">
          <th>Connector Name</th>
        </tr>
      </thead>
      <tbody id="DataConnectorsTableBody"/>
    </table>

    <div class="modal fade" id="dataports_modal" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">
              <div id="dataports_modal_title"></div>
            </h4>
          </div>

          <div class="modal-body">
            <div id="dataports_modal_data"></div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      $(document).ready(function () {
          $('#dtBasicExample').DataTable();
          $('.dataTables_length').addClass('bs-select');
      });

      /* Initialize the bootstrap treeview */
      /*
      $(document).ready(function() {
          $('.treeview-colorful').mdbTreeview();

      });
      */

      function children_of_json(data) {
          return Object.keys(data).length;
      }

      function is_object_empty(data) {
          if(isEmpty(data)) {
              return true;
          } else {
              return false;
          }
      }

      function post_data_ports(target, command) {
          const url = "/DataPorts/" + command;
          var getResponders = $.post( url, { Target : target } )
              .done(function( data ) {
                  if (data) {
                      const count = children_of_json(data);

                      if (command == 'Configuration') {
                      } else if (command == 'Statistics') {
                          console.log(data);
                      } else {
                          var result = '';
                          for (var key of Object.keys(data)) {
                              result += key + ' : ' + data[key] + '<br>';
                          }

                          document.getElementById("dataports_modal_data").innerHTML=result;
                      }

                      for (var key of Object.keys(data)) {
                          console.log(key + " -> " + data[key])
                      }
                  } else {
                      document.getElementById("dataports_modal_data").innerHTML="NULL";
                  }

                  document.getElementById("dataports_modal_title").innerHTML="Data Ports [" + target + ", " + command + "]";
                  $('#dataports_modal').modal('show');
              });
      }

      $.post( "/DataPorts/List", { } ).done(function( data ) {
          for(command in data["Commands"]) {
              $( "#DataPortsTableHeader" ).append('<th>' + data["Commands"][command] + '</th>');
          }

          var TableData = [];
          for(target in data["Items"]) {
              var TableRow = [data["Items"][target]];
              for(command in data["Commands"]) {
                  const row = '<a href="javascript:void(0);" onclick="post_data_ports(\'' + data["Items"][target] + '\', \'' + data["Commands"][command] + '\');">' + data["Commands"][command] + '</a>'
                  TableRow.push(row);
              }
              TableData.push(TableRow);
          }
          $('#DataPortsTable').dataTable({ "data": TableData });
      });

      $.post( "/DataConnectors/List", { } ).done(function( data ) {
          for(command in data["Commands"]) {
              $( "#DataConnectorsTableHeader" ).append('<th>' + data["Commands"][command] + '</th>');
          }

          var TableData = [];
          for(target in data["Items"])
          {
              var TableRow = [data["Items"][target]];
              for(command in data["Commands"])
              {
                  TableRow.push('<a href="' + data["Commands"][command] + '.html#/DataConnectors/' + data["Items"][target] + '">' + data["Commands"][command] + '</a>');
              }
              TableData.push(TableRow);
          }
          $('#DataConnectorsTable').dataTable({"data": TableData });
      });
      </script>
  </body>
</html>
